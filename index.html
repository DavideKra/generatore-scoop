<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<title>Generatore automatico di scoop su Garlasco</title>

<link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@700&family=Special+Elite&display=swap" rel="stylesheet">

<style>
  html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    background: url("sfondo.png") no-repeat center center fixed;
    background-size: cover;
    color: #eee;
    overflow: hidden;
  }

  body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.65);
  }

  body * {
    position: relative;
    z-index: 1;
  }

  h1 {
    text-align: center;
    margin-top: 50px;
    font-family: "Libre Baskerville", serif;
    font-size: 48px;
    letter-spacing: 1.2px;
  }

  #main {
    height: calc(100% - 180px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .slot {
    font-family: "Special Elite", monospace;
    font-size: 32px;
    min-height: 40px;
    letter-spacing: 0.5px;
    transition: color 0.8s ease, text-shadow 0.8s ease;
  }

  .slot.final {
    color: darkred;
    text-shadow: 0 0 14px #700;
  }

  #generate {
    margin-top: 12px;
    padding: 26px 70px;
    font-size: 22px;
    font-family: "Special Elite", monospace;
    letter-spacing: 2px;
    text-transform: uppercase;
    background: transparent;
    color: #eee;
    border: 3px solid #aaa;
    cursor: pointer;
    transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
  }

  #generate:hover {
    border-color: #fff;
    box-shadow: 0 0 20px rgba(255,255,255,0.12);
    transform: scale(1.04);
  }

  #signature {
    position: fixed;
    bottom: 20px;
    right: 25px;
    font-family: "Libre Baskerville", serif;
    font-size: 20px;
    color: #ddd;
    letter-spacing: 1px;
  }
</style>
</head>

<body>
  <h1>Generatore automatico di scoop su Garlasco</h1>

  <div id="main">
    <div class="slot" id="s1"></div>
    <div class="slot" id="s2"></div>
    <div class="slot" id="s3"></div>
    <div class="slot" id="s4"></div>
    <div class="slot" id="s5"></div>
    <div class="slot" id="s6"></div>
    <div class="slot" id="s7"></div>
    <button id="generate">GENERA UNO SCOOP</button>
  </div>

  <div id="signature">Davide*Kra</div>

<script>
/* =========================
   STATO GRAMMATICALE
   =========================
   - sourceNumber guida la 2ª parte
   - subjectGender + subjectNumber guidano 4ª e 6ª parte
*/
let sourceNumber = "sg";
let subjectGender = "m";
let subjectNumber = "sg";

/* =========================
   1) PRIMA PARTE (FONTE) — TUTTO DENTRO + NUOVE AGGIUNTE
   ========================= */
const firstParts = [
  // originali
  { text: "Flaviu Savu", gender: "m", number: "sg" },
  { text: "La setta dei 9 angoli", gender: "f", number: "sg" },
  { text: "Il trafficante di organi umani", gender: "m", number: "sg" },
  { text: "Un super-testimone oculare", gender: "m", number: "sg" },
  { text: "Voci dalla procura", gender: "f", number: "pl" },
  { text: "Un testimone che vuole rimanere anonimo", gender: "m", number: "sg" },
  { text: "Una testimone che vuole rimanere anonima", gender: "f", number: "sg" },
  { text: "Un bastione carico carico di testimoni inattendibili", gender: "m", number: "pl" },
  { text: "Uno cieco dalla nascita", gender: "m", number: "sg" },
  { text: "Un acchiappafantasmi", gender: "m", number: "sg" },
  { text: "Lo scemo del villaggio", gender: "m", number: "sg" },
  { text: "La pettegola del paese", gender: "f", number: "sg" },
  { text: "Un mitomane certificato", gender: "m", number: "sg" },
  { text: "Un muto", gender: "m", number: "sg" },  
  { text: "L'avvocato Gallo", gender: "m", number: "sg" },
  { text: "Luigi Grimaldi", gender: "m", number: "sg" },
  { text: "Il settimanale \"Giallo\"", gender: "m", number: "sg" },
  { text: "Federica Panicucci", gender: "f", number: "sg" },
  { text: "La giornalista Rita Cavallaro", gender: "f", number: "sg" },

  // aggiunte richieste precedenti
  { text: "La Youtuber Bugalalla", gender: "f", number: "sg" },
  { text: "Uno Youtuber a caso", gender: "m", number: "sg" },
  { text: "Fabrizio Corona", gender: "m", number: "sg" },
  { text: "Un blogger di alcuna credibilità", gender: "m", number: "sg" },
  { text: "Un cretino a caso", gender: "m", number: "sg" },

  // nuove aggiunte “rilancio”
  { text: "Il Procuratore Napoleone", gender: "m", number: "sg" },
  { text: "Il Sostituto Civardi", gender: "m", number: "sg" },
  { text: "Un agente della Moscova", gender: "m", number: "sg" },
  { text: "Il capo del RACIS", gender: "m", number: "sg" },
  { text: "Un profiler della CIA", gender: "m", number: "sg" },
  { text: "Un criminologo in disarmo", gender: "m", number: "sg" },
  { text: "Un lettore di gialli sotto l'ombrellone", gender: "m", number: "sg" },
  { text: "Un esperto di tutt'altra materia rispetto a ciò di cui parla", gender: "m", number: "sg" }
];

/* =========================
   2) SECONDA PARTE (VERBO) – 17+17 (COMPLETA)
   ========================= */
const secondParts = {
  sg: [
    "ha affermato che",
    "dice che",
    "pare abbia detto che",
    "secondo voci non confermate dice che",
    "potrebbe aver detto che",
    "secondo indiscrezioni ha detto che",
    "ha sussurrato che",
    "avrebbe dichiarato che",
    "avrebbe confidato che",
    "secondo quanto trapela avrebbe detto che",
    "stando a fonti vicine all'inchiesta avrebbe detto che",
    "avrebbe lasciato intendere che",
    "secondo ambienti giudiziari avrebbe detto che",
    "avrebbe riferito che",
    "a quanto risulta avrebbe detto che",
    "secondo chi lo ha ascoltato avrebbe detto che",
    "in via informale avrebbe detto che",
    "parlando nel sonno avrebbe detto che",
    "consultando i tarocchi avrebbe detto che",
    "dopo aver bevuto un bicchiere di troppo avrebbe detto che",
    "sotto ipnosi avrebbe detto che",
    "dopo una seduta spiritica avrebbe detto che",
    "dopo aver visto un film horror avrebbe detto che",
    "dopo aver letto un romanzo giallo avrebbe detto che",
    "dopo aver fumato una sigaretta particolare avrebbe detto che",
    "dopo un incontro ravvicinato del terzo tipo avrebbe detto che",
    "dopo un viaggio astrale avrebbe detto che",
    "dopo aver mangiato cibo avariato avrebbe detto che",
    "dopo un sogno premonitore avrebbe detto che",
    "dopo aver bevuto una pozione magica avrebbe detto che",
    "dopo essere stato colpito da un fulmine avrebbe detto che",
    "dopo un'esperienza di pre-morte avrebbe detto che",
    "dopo aver partecipato a un rituale occulto avrebbe detto che",
    "dopo aver parlato con un muto ha riferito che",
    "dopo essersi scontrato forte contro un muro avrebbe detto che",
    "dopo aver preso un fungo allucinogeno avrebbe detto che"

  ],
  pl: [
    "hanno affermato che",
    "dicono che",
    "pare che abbiano detto che",
    "secondo voci non confermate dicono che",
    "potrebbero aver detto che",
    "secondo indiscrezioni hanno detto che",
    "hanno sussurrato che",
    "avrebbero dichiarato che",
    "avrebbero confidato che",
    "secondo quanto trapela avrebbero detto che",
    "stando a fonti vicine all'inchiesta avrebbero detto che",
    "avrebbero lasciato intendere che",
    "secondo ambienti giudiziari avrebbero detto che",
    "avrebbero riferito che",
    "a quanto risulta avrebbero detto che",
    "secondo chi li ha ascoltati avrebbero detto che",
    "in via informale avrebbero detto che",
    "sussurrando nel sonno avrebbero detto che",
    "dopo esserselo immaginato avrebbero detto che",
    "bevendo un bicchiere di troppo avrebbero detto che",
    "sotto ipnosi avrebbero detto che",
    "dopo una seduta spiritica avrebbero detto che",
    "dopo aver visto un film horror avrebbero detto che",
    "dopo aver letto un romanzo giallo avrebbero detto che",
    "dopo aver fumato una sigaretta particolare avrebbero detto che",
    "dopo un incontro ravvicinato del terzo tipo avrebbero detto che",
    "dopo un viaggio astrale avrebbero detto che",
    "dopo aver mangiato cibo avariato avrebbero detto che",
    "dopo un sogno premonitore avrebbero detto che",
    "dopo essere caduti in una pozione magica avrebbero detto che",
    "dopo essere stati colpiti da un fulmine avrebbero detto che"
  ]
};

/* =========================
   3) TERZA PARTE (SOGGETTO) – 18 (COMPLETA)
   - Nota: "l'intera famiglia" = FEMMINILE SINGOLARE (accordo grammaticale)
   ========================= */
const thirdParts = [
  { text: "Michele Bertani", gender: "m", number: "sg" },
  { text: "Andrea Sempio", gender: "m", number: "sg" },
  { text: "Ermanno Cappa", gender: "m", number: "sg" },
  { text: "Stefania Cappa", gender: "f", number: "sg" },
  { text: "Paola Cappa", gender: "f", number: "sg" },
  { text: "Giuseppe Sempio", gender: "m", number: "sg" },
  { text: "Marco Poggi", gender: "m", number: "sg" },
  { text: "Roberto Freddi", gender: "m", number: "sg" },
  { text: "un abitante di Garlasco", gender: "m", number: "sg" },
  { text: "la colf della Famiglia Cappa", gender: "f", number: "sg" },
  { text: "il fidanzato di un salumiere di Garlasco", gender: "m", number: "sg" },
  { text: "l'ex fidanzato di Stefania Cappa", gender: "m", number: "sg" },
  { text: "un passante di Garlasco", gender: "m", number: "sg" },
  { text: "un non vedente di Garlasco", gender: "m", number: "sg" },
  { text: "un goblin di Garlasco", gender: "m", number: "sg" },
  { text: "un mitomane di Garlasco", gender: "m", number: "sg" },
  { text: "un compagno di scuola di Sempio", gender: "m", number: "sg" },
  { text: "l'insegnante di Andrea Sempio", gender: "m", number: "sg" },
  { text: "l'istruttore di scuola guida di Sempio", gender: "m", number: "sg" },
  { text: "un vicino di casa di Sempio", gender: "m", number: "sg" },
  { text: "l'amico di un amico del cugino di Sempio", gender: "m", number: "sg" },
  { text: "l'intera famiglia Poggi", gender: "f", number: "sg" },
  { text: "l'intera famiglia Cappa", gender: "f", number: "sg" },
  { text: "l'intera famiglia Sempio", gender: "f", number: "sg" },
  { text: "un parente alla lontana di un cugino di terzo grado di Sempio", gender: "m", number: "sg" }
];

/* =========================
   4) QUARTA PARTE (AVVISTAMENTO) – 24, declinate per genere/numero
   ========================= */
const fourthTemplates = [
  // 1-4 (tue)
  { type: "PP", base: "essere visto" },
  { type: "PP_MODAL", base: "essere notato" },
  { type: "PP_PARE", base: "essere intravisto" },
  { type: "PP_FORSE_CODA", base: "essere visto con la coda dell'occhio" },

  // 5-24
  { type: "PP", base: "essere notato" },
  { type: "PP", base: "essere visto di sfuggita" },
  { type: "PARE_PER_ATTIMO" },
  { type: "GIURA_AVERE_VISTO" },
  { type: "SECONDO_ALCUNI" },
  { type: "PP", base: "essere avvistato brevemente" },
  { type: "PARE_PRESENTE" },
  { type: "DICE_AVERE_INTRAVISTO" },
  { type: "PP", base: "essere comparso per pochi istanti" },
  { type: "PARE_LI" },
  { type: "SECONDO_TESTIMONIANZA" },
  { type: "SOSTIENE_AVERE_NOTATO" },
  { type: "PARE_PASSARE_INOSSERVATO" },
  { type: "PP", base: "essere visto da lontano" },
  { type: "AFFERMA_AVERE_VISTO" },
  { type: "PARE_NEI_PARAGGI" },
  { type: "PP", base: "essere notato solo per un momento" },
  { type: "SECONDO_RICOSTRUZIONE" },
  { type: "PARE_QUALCUNO_LO_ABBIA_VISTO" },
  { type: "PP", base: "essere visto ma non riconosciuto" }
];

function ppForms(g, n, verbInf, extra = "") {
  const isF = (g === "f");
  const isPl = (n === "pl");

  const essere = isPl ? "sono" : "è";
  const stato = isPl ? (isF ? "state" : "stati") : (isF ? "stata" : "stato");

  const map = {
    "visto":      { m:{sg:"visto",  pl:"visti"},  f:{sg:"vista",  pl:"viste"} },
    "notato":     { m:{sg:"notato", pl:"notati"}, f:{sg:"notata", pl:"notate"} },
    "intravisto": { m:{sg:"intravisto", pl:"intravisti"}, f:{sg:"intravista", pl:"intraviste"} },
    "avvistato":  { m:{sg:"avvistato", pl:"avvistati"}, f:{sg:"avvistata", pl:"avvistate"} },
    "comparso":   { m:{sg:"comparso", pl:"comparsi"}, f:{sg:"comparsa", pl:"comparse"} },
    "riconosciuto": { m:{sg:"riconosciuto", pl:"riconosciuti"}, f:{sg:"riconosciuta", pl:"riconosciute"} }
  };

  const part = map[verbInf]?.[g]?.[n] ?? verbInf;
  return `${essere} ${stato} ${part}${extra ? " " + extra : ""}`;
}

function objPronoun(g, n) {
  const isF = (g === "f");
  const isPl = (n === "pl");
  if (!isPl && !isF) return "lo";
  if (!isPl && isF)  return "la";
  if (isPl && !isF)  return "li";
  return "le";
}

function buildFourthParts(g, n) {
  const p = objPronoun(g, n);
  const isPl = (n === "pl");
  const isF = (g === "f");

  const out = [];
  for (const t of fourthTemplates) {
    switch (t.type) {
      case "PP": {
        const pieces = t.base.replace("essere ", "").split(" ");
        const verbInf = pieces[0];
        const extra = pieces.slice(1).join(" ");
        out.push(ppForms(g, n, verbInf, extra));
        break;
      }
      case "PP_MODAL": {
        const pot = isPl ? "potrebbero" : "potrebbe";
        const stato = isPl ? (isF ? "state" : "stati") : (isF ? "stata" : "stato");
        const mapNotato = { m:{sg:"notato", pl:"notati"}, f:{sg:"notata", pl:"notate"} };
        out.push(`${pot} essere ${stato} ${mapNotato[g][n]}`);
        break;
      }
      case "PP_PARE": {
        const aux = isPl ? "siano" : "sia";
        const stato = isPl ? (isF ? "state" : "stati") : (isF ? "stata" : "stato");
        const map = { m:{sg:"intravisto", pl:"intravisti"}, f:{sg:"intravista", pl:"intraviste"} };
        out.push(`pare che ${aux} ${stato} ${map[g][n]}`);
        break;
      }
      case "PP_FORSE_CODA": {
        const aux = isPl ? "siano" : "sia";
        const stato = isPl ? (isF ? "state" : "stati") : (isF ? "stata" : "stato");
        const map = { m:{sg:"visto", pl:"visti"}, f:{sg:"vista", pl:"viste"} };
        out.push(`forse ${aux} ${stato} ${map[g][n]} con la coda dell'occhio`);
        break;
      }
      case "PARE_PER_ATTIMO": {
        out.push(isPl ? "pare siano stati notati per un attimo" : "pare sia stato notato per un attimo");
        if (isF && !isPl) out[out.length-1] = "pare sia stata notata per un attimo";
        if (isF && isPl)  out[out.length-1] = "pare siano state notate per un attimo";
        break;
      }
      case "GIURA_AVERE_VISTO": {
        out.push(`qualcuno giura di aver${p} visto`);
        break;
      }
      case "SECONDO_ALCUNI": {
        out.push(isPl ? "secondo alcuni sarebbero stati visti" : "secondo alcuni sarebbe stato visto");
        if (isF && !isPl) out[out.length-1] = "secondo alcuni sarebbe stata vista";
        if (isF && isPl)  out[out.length-1] = "secondo alcuni sarebbero state viste";
        break;
      }
      case "PARE_PRESENTE": {
        out.push(isPl ? "pare fossero presenti" : "pare fosse presente");
        break;
      }
      case "DICE_AVERE_INTRAVISTO": {
        out.push(`qualcuno dice di aver${p} intravist${isPl ? (isF ? "e" : "i") : (isF ? "a" : "o")}`);
        break;
      }
      case "PARE_LI": {
        out.push(isPl ? "pare fossero lì" : "pare fosse lì");
        break;
      }
      case "SECONDO_TESTIMONIANZA": {
        out.push(isPl ? "secondo una testimonianza sarebbero stati visti" : "secondo una testimonianza sarebbe stato visto");
        if (isF && !isPl) out[out.length-1] = "secondo una testimonianza sarebbe stata vista";
        if (isF && isPl)  out[out.length-1] = "secondo una testimonianza sarebbero state viste";
        break;
      }
      case "SOSTIENE_AVERE_NOTATO": {
        out.push(`qualcuno sostiene di aver${p} notat${isPl ? (isF ? "e" : "i") : (isF ? "a" : "o")}`);
        break;
      }
      case "PARE_PASSARE_INOSSERVATO": {
        out.push(isPl ? "pare siano passati inosservati" : "pare sia passato inosservato");
        if (isF && !isPl) out[out.length-1] = "pare sia passata inosservata";
        if (isF && isPl)  out[out.length-1] = "pare siano passate inosservate";
        break;
      }
      case "AFFERMA_AVERE_VISTO": {
        out.push(`qualcuno afferma di aver${p} visto`);
        break;
      }
      case "PARE_NEI_PARAGGI": {
        out.push(isPl ? "pare che fossero nei paraggi" : "pare che fosse nei paraggi");
        break;
      }
      case "SECONDO_RICOSTRUZIONE": {
        out.push(isPl ? "secondo una ricostruzione sarebbero stati visti" : "secondo una ricostruzione sarebbe stato visto");
        if (isF && !isPl) out[out.length-1] = "secondo una ricostruzione sarebbe stata vista";
        if (isF && isPl)  out[out.length-1] = "secondo una ricostruzione sarebbero state viste";
        break;
      }
      case "PARE_QUALCUNO_LO_ABBIA_VISTO": {
        const aux = isPl ? "abbiano" : "abbia";
        out.push(`pare che qualcuno ${aux} ${p} visto`);
        if (isF && !isPl) out[out.length-1] = `pare che qualcuno ${aux} ${p} vista`;
        if (isF && isPl)  out[out.length-1] = `pare che qualcuno ${aux} ${p} viste`;
        if (!isF && isPl) out[out.length-1] = `pare che qualcuno ${aux} ${p} visti`;
        break;
      }
      default:
        out.push(ppForms(g, n, "visto"));
    }
  }
  return out.slice(0, 24);
}

/* =========================
   5) QUINTA PARTE (TEMPO) – 21
   ========================= */
const fifthParts = [
  "proprio la sera precedente rispetto al momento in cui è avvenuto il delitto",
  "proprio la mattina in cui è avvenuto il delitto",
  "proprio nella settimana in cui è avvenuto il delitto",
  "proprio in quell'agosto in cui è avvenuto il delitto",
  "proprio nelle stesse ore in cui è avvenuto il delitto",
  "proprio nel mese in cui è avvenuto il delitto",
  "proprio all'alba del giorno in cui è avvenuto il delitto",
  "proprio nelle prime ore della mattina in cui è avvenuto il delitto",
  "proprio poche ore prima del momento in cui è avvenuto il delitto",
  "proprio durante la mattinata in cui è avvenuto il delitto",
  "proprio nelle ore immediatamente precedenti al momento in cui è avvenuto il delitto",
  "proprio a ridosso della mattina in cui è avvenuto il delitto",
  "proprio nella notte precedente il giorno in cui è avvenuto il delitto",
  "proprio nelle primissime ore del giorno in cui è avvenuto il delitto",
  "proprio in quella mattina d'agosto in cui è avvenuto il delitto",
  "proprio nel giorno in cui è avvenuto il delitto",
  "proprio nel periodo a cavallo del giorno in cui è avvenuto il delitto",
  "proprio in coincidenza temporale con la mattina in cui è avvenuto il delitto",
  "proprio poco prima dell'orario in cui è avvenuto il delitto",
  "proprio nel periodo immediatamente precedente in cui è avvenuto il delitto",
  "proprio in un momento compatibile con quello in cui è avvenuto il delitto",
  "proprio nell'intervallo di tempo in cui è avvenuto il delitto",
  "proprio in un arco temporale coincidente con quello in cui è avvenuto il delitto",
  "proprio nella stessa fascia oraria in cui è avvenuto il delitto"
];

/* =========================
   6) SESTA PARTE (AZIONE) – 21+21 e FINISCE SEMPRE CON "di"
   ========================= */
const sixthParts = {
  sg: [
    "mentre comprava",
    "mentre acquistava",
    "mentre era in coda per comprare",
    "mentre ordinava su Amazon",
    "proprio mentre provava a chiedere ad una commessa di avere",
    "mentre chiedeva ad un passante di comprare per lui",
    "mentre faceva la spesa",
    "mentre si fermava a comprare",
    "mentre era in fila per l'acquisto di",
    "mentre cercava di comprare",
    "mentre effettuava un acquisto di",
    "mentre stava pagando",
    "mentre era intento ad acquistare",
    "mentre provava ad acquistare",
    "mentre chiedeva insistentemente informazioni su",
    "mentre trattava con un commesso l'acquisto di",
    "mentre concludeva un acquisto di",
    "mentre stava facendo un ordine di",
    "mentre si informava su come comprare",
    "mentre stava per acquistare",
    "mentre cercava qualcuno che comprasse per lui",
    "mentre chiedeva a un passante di comprare",
    "mentre cercava di finalizzare un acquisto di",
    "mentre stava per pagare in banconote di piccolo taglio",
    "mentre, parlando con l'accento svedese, chiedeva di comprare",
    "mentre, fingendosi un agente segreto, ordinava l'acquisto di",
    "mentre, travestito da clown, cercava di comprare",
    "mentre, sotto copertura, stava per acquistare",
    "mentre, in incognito, si informava su come comprare", 
    "mentre, con fare sospetto, stava per pagare",
    "mentre, con voce tremante, chiedeva ad un passante di comprare",
    "mentre, tutto trafelato, cercava di finalizzare l'acquisto di"

  ],
  pl: [
    "mentre compravano",
    "mentre acquistavano",
    "mentre erano in coda per comprare",
    "mentre ordinavano su Amazon",
    "proprio mentre provavano a chiedere di avere",
    "mentre chiedevano ad un passante di comprare",
    "mentre si fermavano a comprare",
    "mentre erano in fila per l'acquisto di",
    "mentre cercavano di comprare",
    "mentre effettuavano un acquisto di",
    "mentre stavano pagando",
    "mentre erano intenti ad acquistare",
    "mentre provavano ad acquistare",
    "mentre concludevano un acquisto di",
    "mentre stavano facendo l'ordine di",
    "mentre si informavano su come comprare",
    "mentre stavano per acquistare",
    "mentre cercavano qualcuno che comprasse per loro",
    "mentre chiedevano a un passante di comprare",
    "mentre cercavano di finalizzare un acquisto di",
    "mentre stavano per pagare in banconote di piccolo taglio",
    "mentre, parlando con l'accento svedese, chiedevano di comprare",
    "mentre, fingendosi agenti segreti, ordinavano l'acquisto di",
    "mentre, travestiti da clown, cercavano di comprare",
    "mentre, sotto copertura, stavano per acquistare",
    "mentre, in incognito, si informavano su come comprare", 
    "mentre, con fare sospetto, stavano per pagare",
    "mentre, con voce tremante, chiedevano ad un passante di comprare",
    "mentre, tutti trafelati, cercavano di finalizzare l'acquisto di"
  ]
};

/* =========================
   7) SETTIMA PARTE (OGGETTO) – 11
   ========================= */
const seventhParts = [
  "un set di mutande sataniche",
  "un cammello omicida",
  "un baby tonfa",
  "un bazooka",
  "una mazza medievale",
  "un bastone da Mustafà",
  "un'arma non convenzionale",
  "un arsenale atomico",
  "un sicario dall'America",
  "una tessera della \"Setta dei 9 angoli\"",
  "un'iscrizione ai satanisti",
  "una stampella con i simboli occulti",
  "set di armi bianche",
  "delle scarpe Frau numero 42",
  "un kit per il perfetto assassino",
  "2.5 grammi di DNA di Chiara Poggi"];

/* =========================
   ENGINE SLOT + RIGENERA
   ========================= */
const slots = [
  document.getElementById("s1"),
  document.getElementById("s2"),
  document.getElementById("s3"),
  document.getElementById("s4"),
  document.getElementById("s5"),
  document.getElementById("s6"),
  document.getElementById("s7")
];
const btn = document.getElementById("generate");

function pick(items) {
  return items[Math.floor(Math.random() * items.length)];
}

function spin(slot, items, onFinal) {
  let last = null;
  const interval = setInterval(() => {
    last = pick(items);
    slot.textContent = last.text ?? last;
  }, 200);

  setTimeout(() => {
    clearInterval(interval);
    const finalItem = pick(items);
    slot.textContent = finalItem.text ?? finalItem;
    slot.classList.add("final");
    if (onFinal) onFinal(finalItem);
  }, 1400);
}

function resetUI() {
  slots.forEach(s => { s.textContent = ""; s.classList.remove("final"); });
}

function start() {
  btn.style.display = "none";
  resetUI();

  // 1) fonte -> imposta sourceNumber
  spin(slots[0], firstParts, (it1) => {
    sourceNumber = it1.number;

    // 2) verbo (dipende dal numero della fonte)
    spin(slots[1], secondParts[sourceNumber], () => {

      // 3) soggetto -> imposta subjectGender/subjectNumber
      spin(slots[2], thirdParts, (it3) => {
        subjectGender = it3.gender;
        subjectNumber = it3.number;

        // 4) avvistamento (dipende da genere/numero del soggetto)
        const fourthParts = buildFourthParts(subjectGender, subjectNumber);
        spin(slots[3], fourthParts, () => {

          // 5) tempo
          spin(slots[4], fifthParts, () => {

            // 6) azione (dipende dal numero del soggetto)
            spin(slots[5], sixthParts[subjectNumber], () => {

              // 7) oggetto
              spin(slots[6], seventhParts, () => {
                btn.textContent = "GENERA UN ALTRO SCOOP";
                btn.style.display = "inline-block";
              });
            });
          });
        });
      });
    });
  });
}

btn.addEventListener("click", start);

/* =========================
   CONTEGGIO COMBINAZIONI
   ========================= */
(() => {
  const part1 = firstParts.length;            // 24
  const part2_sg = secondParts.sg.length;     // 17
  const part2_pl = secondParts.pl.length;     // 17
  const part3 = thirdParts.length;            // 18
  const part4 = 24;                           // 24
  const part5 = fifthParts.length;            // 21
  const part6_sg = sixthParts.sg.length;      // 21
  const part6_pl = sixthParts.pl.length;      // 21
  const part7 = seventhParts.length;          // 11

  const sourcesSg = firstParts.filter(x => x.number === "sg").length; // 23
  const sourcesPl = firstParts.filter(x => x.number === "pl").length; // 1

  const subjectsSg = thirdParts.filter(x => x.number === "sg").length; // 18
  const subjectsPl = thirdParts.filter(x => x.number === "pl").length; // 0

  const total =
    (sourcesSg * part2_sg + sourcesPl * part2_pl) *
    part3 *
    part4 *
    part5 *
    (subjectsSg * part6_sg + subjectsPl * part6_pl) *
    part7;

  console.log("Opzioni per parte:", { part1, part2_sg, part2_pl, part3, part4, part5, part6_sg, part6_pl, part7 });
  console.log("Combinazioni totali:", total); // 855,017,856
})();
</script>
</body>
</html>
